syntax = "proto3";

package monitoring;

import "google/protobuf/empty.proto";

// Service definition for Monitor Agent <-> gRPC Server bidirectional communication
service MonitoringService {
    // Bidirectional streaming: Agent sends metrics AND receives commands
    rpc StreamMetrics(stream MetricsRequest) returns (stream Command);
    
    // Send command to a specific agent (from external clients/Kafka)
    rpc SendCommand(Command) returns (CommandResponse);
}

// ============================================================================
// Monitoring Data Messages
// ============================================================================

message SystemMetrics {
    double cpu_percent = 1;
    double memory_percent = 2;
    double memory_used_mb = 3;
    double memory_total_mb = 4;
    double disk_read_mb = 5;
    double disk_write_mb = 6;
    double net_in_mb = 7;
    double net_out_mb = 8;
}

message MetricsRequest {
    string agent_id = 1;
    int64 timestamp = 2;  // Unix timestamp
    SystemMetrics metrics = 3;
    map<string, string> metadata = 4;
}

// ============================================================================
// Command Messages
// ============================================================================

// Command types
enum CommandType {
    START = 0;           // Start collecting metrics
    STOP = 1;            // Stop collecting metrics
    UPDATE_CONFIG = 2;   // Update configuration
    RESTART = 3;         // Restart agent
    STATUS = 4;          // Get agent status
}

// Command for agent
message Command {
    string agent_id = 1;           // Target agent ID
    CommandType type = 2;          // Command type
    map<string, string> params = 3; // Optional parameters
    int64 timestamp = 4;           // Command timestamp
}

// Response to command
message CommandResponse {
    bool success = 1;              // Whether command was executed successfully
    string message = 2;            // Response message
    string agent_id = 3;           // Agent that executed the command
    int64 timestamp = 4;           // Response timestamp
}





