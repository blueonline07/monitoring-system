syntax = "proto3";

package monitoring;

// Service definition for Monitor Agent <-> gRPC Server communication
// Following Lab 2 bidirectional streaming pattern:
// - Agent sends periodic monitoring data (stream MetricsRequest)
// - Server sends commands to agent (stream Command)
// Pattern: rpc CommandStream (stream CommandResponse) returns (stream CommandRequest);
service MonitoringService {
    // Bidirectional streaming: Agent sends periodic metrics, Server sends commands
    // Pattern matches Lab 2: stream from client (agent) -> stream from server (commands)
    // All commands are sent through this bidirectional stream - no separate RPC needed
    rpc StreamMetrics(stream MetricsRequest) returns (stream Command);
}

// ============================================================================
// Monitoring Data Messages
// ============================================================================

message SystemMetrics {
    double cpu_percent = 1;
    double memory_percent = 2;
    double memory_used_mb = 3;
    double memory_total_mb = 4;
    double disk_read_mb = 5;
    double disk_write_mb = 6;
    double net_in_mb = 7;
    double net_out_mb = 8;
}

message MetricsRequest {
    string agent_id = 1;
    int64 timestamp = 2;  // Unix timestamp
    SystemMetrics metrics = 3;
    map<string, string> metadata = 4;
}

// ============================================================================
// Command Messages
// ============================================================================

// Command types
enum CommandType {
    // Reserved for future commands
}

// Command for agent
message Command {
    string agent_id = 1;  // Target agent ID
    CommandType type = 2;  // Command type
    map<string, string> parameters = 3;  // Optional command parameters
}




